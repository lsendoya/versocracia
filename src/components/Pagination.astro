---
/**
 * Props:
 * - current: number (página actual, >=1)
 * - totalPages: number (>=1)
 * - baseUrl: string (ruta base, ej: "/politica/" o "/literatura/")
 * Genera enlaces con query `?page=` salvo la página 1, que apunta a baseUrl.
 */
const { current = 1, totalPages = 1, baseUrl = "/" } = Astro.props;

function pageHref(n) {
  return n === 1 ? baseUrl : `${baseUrl}?page=${n}`;
}

const window = 2;
const start = Math.max(1, current - window);
const end = Math.min(totalPages, current + window);
const pages = Array.from({ length: end - start + 1 }, (_, i) => start + i);
---

{
  totalPages > 1 && (
    <nav class="my-8 flex items-center justify-center gap-1" aria-label="paginación">
      <a
        class={`text-tinta inline-flex h-9 w-9 items-center justify-center rounded-xl border bg-white ${current === 1 ? "pointer-events-none opacity-50" : "hover:shadow"}`}
        href={pageHref(1)}
        aria-label="Primera"
        rel="first"
      >
        «
      </a>
      <a
        class={`text-tinta inline-flex h-9 w-9 items-center justify-center rounded-xl border bg-white ${current === 1 ? "pointer-events-none opacity-50" : "hover:shadow"}`}
        href={pageHref(Math.max(1, current - 1))}
        aria-label="Anterior"
        rel="prev"
      >
        ‹
      </a>

      {start > 1 && <span class="text-pizarra/70 px-1">…</span>}
      {pages.map((p) => (
        <a
          href={pageHref(p)}
          aria-current={p === current ? "page" : undefined}
          class={`inline-flex h-9 w-9 items-center justify-center rounded-xl border ${p === current ? "bg-carmin border-carmin text-white" : "text-tinta bg-white hover:shadow"}`}
        >
          {p}
        </a>
      ))}
      {end < totalPages && <span class="text-pizarra/70 px-1">…</span>}

      <a
        class={`text-tinta inline-flex h-9 w-9 items-center justify-center rounded-xl border bg-white ${current === totalPages ? "pointer-events-none opacity-50" : "hover:shadow"}`}
        href={pageHref(Math.min(totalPages, current + 1))}
        aria-label="Siguiente"
        rel="next"
      >
        ›
      </a>
      <a
        class={`text-tinta inline-flex h-9 w-9 items-center justify-center rounded-xl border bg-white ${current === totalPages ? "pointer-events-none opacity-50" : "hover:shadow"}`}
        href={pageHref(totalPages)}
        aria-label="Última"
        rel="last"
      >
        »
      </a>
    </nav>
  )
}
